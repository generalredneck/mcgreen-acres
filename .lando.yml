name: mcgreen-acres
recipe: drupal11
config:
  database: mariadb:11.4
  webroot: web
  xdebug: true
  php: "8.4"
  composer_version: 2
services:
  appserver:
    build_as_root:
      - apt-get update && apt-get install -y libfaketime # Installs libfaketime
    environment:
      LD_PRELOAD: /usr/lib/x86_64-linux-gnu/faketime/libfaketime.so.1 # Preloads the library
  #    FAKETIME: "@2026-01-01 09:00:00" # Sets the faked time and starts the clock
  mail:
    type: mailpit
    mailFrom:
      - appserver
proxy:
  mail:
    - mail-mcgreen-acres.lndo.site
tooling:
  drush:
    service: appserver
    cmd: "drush --root=/app/web --uri=http://mcgreen-acres.lndo.site"
  build:
    service: appserver
    cmd:
      - composer install
      - /app/vendor/bin/drush sql-drop -y
      - /app/vendor/bin/drush sql-sync @prod @self -y
      - /app/vendor/fourkitchens/pots/scripts/general/remote/drush-commands "" "/app/vendor/bin/drush --root=/app/web --uri=http://mcgreen-acres.lndo.site" "YES"
