@import "../defaults";

/**
 * @file
 * AI Image Alt Text Inline Button Admin Styles.
 *
 * This file handles the layout and styling for the AI-powered alt text
 * generation button integrated inline with image upload forms.
 * Supports all media image fields including field-media-image,
 * field-media-cover-image, and other variants.
 *
 * JavaScript adds the 'ai-inline-mode' class to enable inline layout on
 * screens >= 1200px and removes it on smaller screens.
 */

@media (min-width: 1200px) {

  // Grid Layout Container.
  // ---------------------------------------------------------------------------
  .form-managed-file__meta-items.ai-inline-mode,
  body .form-managed-file__meta-items.ai-inline-mode {
    display: grid !important;
    grid-template-columns: minmax(0, 1fr) auto !important;
    grid-auto-rows: auto !important;
    gap: 0 !important;
    align-items: start !important;
  }

  .form-managed-file__meta {
    .form-item {
      max-width: none !important;
    }
  }

  // Ensure form-wrapper doesn't restrict width.
  .ai-inline-mode .form-wrapper,
  body .ai-inline-mode .form-wrapper {
    max-width: none !important;
    width: 100% !important;
  }

  // Field Display & Layout.
  // ---------------------------------------------------------------------------

  // Alt and Title fields: block display for proper label positioning.
  .ai-inline-mode [class*="js-form-item"][class*="field"][class*="media"][class*="image"][class*="-alt"],
  body .ai-inline-mode [class*="js-form-item"][class*="field"][class*="media"][class*="image"][class*="-alt"],
  .ai-inline-mode [class*="form-item"][class*="field"][class*="media"][class*="image"][class*="-alt"],
  body .ai-inline-mode [class*="form-item"][class*="field"][class*="media"][class*="image"][class*="-alt"],
  .ai-inline-mode [class*="js-form-item"][class*="field"][class*="media"][class*="image"][class*="-title"],
  body .ai-inline-mode [class*="js-form-item"][class*="field"][class*="media"][class*="image"][class*="-title"],
  .ai-inline-mode [class*="form-item"][class*="field"][class*="media"][class*="image"][class*="-title"],
  body .ai-inline-mode [class*="form-item"][class*="field"][class*="media"][class*="image"][class*="-title"] {
    display: block !important;
  }

  // Alt field: grid positioning.
  .form-managed-file__meta-items.ai-inline-mode {
    > [class*="js-form-item"][class*="field"][class*="media"][class*="image"][class*="-alt"],
    body & > [class*="js-form-item"][class*="field"][class*="media"][class*="image"][class*="-alt"],
    > [class*="form-item"][class*="field"][class*="media"][class*="image"][class*="-alt"],
    body & > [class*="form-item"][class*="field"][class*="media"][class*="image"][class*="-alt"] {
      grid-column: 1 / 2 !important;
      grid-row: 1 / 2 !important;
      margin-block-end: 1rem !important;
      z-index: 1 !important;
    }

    // Title field: grid positioning.
    > [class*="js-form-item"][class*="field"][class*="media"][class*="image"][class*="-title"],
    body & > [class*="js-form-item"][class*="field"][class*="media"][class*="image"][class*="-title"],
    > [class*="form-item"][class*="field"][class*="media"][class*="image"][class*="-title"],
    body & > [class*="form-item"][class*="field"][class*="media"][class*="image"][class*="-title"] {
      grid-column: 1 / 2 !important;
      grid-row: 2 / 3 !important;
    }

    // Other fields: full width.
    > *:not(.ai-alt-text-generation-wrapper):not([class*="field"][class*="media"][class*="image"][class*="-alt"]):not([class*="field"][class*="media"][class*="image"][class*="-title"]) {
      grid-column: 1 / -1 !important;
    }

    // AI Button wrapper grid positioning.
    > .ai-alt-text-generation-wrapper,
    body & > .ai-alt-text-generation-wrapper {
      grid-column: 2 / 3 !important;
      grid-row: 1 / 2 !important;
      align-self: end !important;
      padding: 0 !important;
      margin: 0 !important;
      margin-block-end: 1.45rem !important;
      z-index: 2 !important;
    }
  }

  // Input Wrapper Configuration.
  // ---------------------------------------------------------------------------

  // Alt field input wrapper.
  .ai-inline-mode [class*="js-form-item"][class*="field"][class*="media"][class*="image"][class*="-alt"],
  body .ai-inline-mode [class*="js-form-item"][class*="field"][class*="media"][class*="image"][class*="-alt"],
  .ai-inline-mode [class*="form-item"][class*="field"][class*="media"][class*="image"][class*="-alt"],
  body .ai-inline-mode [class*="form-item"][class*="field"][class*="media"][class*="image"][class*="-alt"] {
    .help-icon__element-has-description,
    .ai-input-button-wrapper {
      display: flex !important;
      align-items: stretch !important;
      gap: 0 !important;
      flex-wrap: nowrap !important;
      width: 100% !important;
      min-width: 0 !important;

      > * {
        margin: 0 !important;
      }
    }
  }

  // Title field input wrapper.
  .form-managed-file__meta-items.ai-inline-mode {
    > [class*="js-form-item"][class*="field"][class*="media"][class*="image"][class*="-title"],
    body & > [class*="js-form-item"][class*="field"][class*="media"][class*="image"][class*="-title"],
    > [class*="form-item"][class*="field"][class*="media"][class*="image"][class*="-title"],
    body & > [class*="form-item"][class*="field"][class*="media"][class*="image"][class*="-title"] {
      .help-icon__element-has-description {
        display: flex !important;
        align-items: stretch !important;
        gap: 0 !important;
        flex-wrap: nowrap !important;
        width: 100% !important;

        > * {
          margin: 0 !important;
        }
      }
    }
  }

  // Input Field Styling.
  // ---------------------------------------------------------------------------

  // Base input styles for all media image fields (alt and title).
  .ai-inline-mode [class*="js-form-item"][class*="field"][class*="media"][class*="image"][class*="-alt"],
  body .ai-inline-mode [class*="js-form-item"][class*="field"][class*="media"][class*="image"][class*="-alt"],
  .ai-inline-mode [class*="form-item"][class*="field"][class*="media"][class*="image"][class*="-alt"],
  body .ai-inline-mode [class*="form-item"][class*="field"][class*="media"][class*="image"][class*="-alt"],
  .ai-inline-mode [class*="js-form-item"][class*="field"][class*="media"][class*="image"][class*="-title"],
  body .ai-inline-mode [class*="js-form-item"][class*="field"][class*="media"][class*="image"][class*="-title"],
  .ai-inline-mode [class*="form-item"][class*="field"][class*="media"][class*="image"][class*="-title"],
  body .ai-inline-mode [class*="form-item"][class*="field"][class*="media"][class*="image"][class*="-title"] {
    input[type="text"] {
      flex: 1 1 auto !important;
      min-width: fit-content !important;
      max-width: none !important;
      width: 100% !important;
      margin: 0 !important;
    }
  }

  // Alt field specific: flat inline-end edge for inline button.
  .ai-inline-mode [class*="js-form-item"][class*="field"][class*="media"][class*="image"][class*="-alt"],
  body .ai-inline-mode [class*="js-form-item"][class*="field"][class*="media"][class*="image"][class*="-alt"],
  .ai-inline-mode [class*="form-item"][class*="field"][class*="media"][class*="image"][class*="-alt"],
  body .ai-inline-mode [class*="form-item"][class*="field"][class*="media"][class*="image"][class*="-alt"] {
    input[type="text"] {
      border-start-end-radius: 0 !important;
      border-end-end-radius: 0 !important;
      border-inline-end: 0 !important;
    }
  }

  // AI Button Wrapper & Styling.
  // ---------------------------------------------------------------------------

  // Button styling when in inline mode.
  .ai-inline-mode .ai-alt-text-generation-wrapper,
  body .ai-inline-mode .ai-alt-text-generation-wrapper {
    display: flex;
    flex-direction: row;
    .ai-alt-text-generation {
      display: inline-block !important;
      visibility: visible !important;
      opacity: 1 !important;
      margin: 0 !important;
      padding-block: 0.5rem !important;
      padding-inline: 1rem !important;
      block-size: 40px !important;
      height: 1rem;
      line-height: 1 !important;
      min-inline-size: fit-content !important;
      max-inline-size: 180px !important;
      border-start-start-radius: 0 !important;
      border-end-start-radius: 0 !important;
      border-inline-start: 0 !important;
      white-space: nowrap !important;
      overflow: hidden !important;
      text-overflow: ellipsis !important;
    }
  }
}

